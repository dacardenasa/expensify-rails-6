<!-- Template js to add created item to the table through render row template -->
<% if @expense.errors.empty? %>
  // Update info expense into table
  var current_month = $(".dropdown button").attr("name");
  var filter = false;

  $( ".filter-type a" ).each(function( index ) {
    if ( $( this ).hasClass("active") ) {
      filter = true;
      return false;
    }
  });

  if( current_month == "<%= j Date::MONTHNAMES[@expense.date.month] %>" && !filter ) {
    $('table tbody').prepend(' <%= j render "row", expense: @expense %>');

    var formatter = new Intl.NumberFormat('en-US', {
      style: 'currency',
      currency: 'USD',
    });

    var expenseAmount = <%= j @expense.amount %>
    var totalAmount = Number($("#total").text().replace("$", "").replace(",", ""));

    var total = totalAmount + expenseAmount; 
    var transactions = Number($("#transactions").text()) + 1;
    var average = total / transactions;

    $("#total").html( `${formatter.format(total)}` );
    $("#transactions").html(`${ transactions }`);
    $("#average").html( `${formatter.format(average)}` );

  }

  // Show sucess alert to user
  swal({
  title: "Expense created!",
  text: "The <%= j "#{ @expense.type } #{ @expense.concept } for #{ number_to_currency(@expense.amount) } on #{ @expense.date } was created successfully!" %> ",
  icon: "success",
  button: "ok",
  });

  // Hide modal
  $('#modal-articles').modal("hide");
  $('.modal-backdrop').remove();

<% else %>
  // Show error alert to user
  swal({
    title: "Something went wrong!",
    text: "<%= j @expense.errors.full_messages[0] %>",
    icon: "error",
    button: "ok",
  });
<% end %>
